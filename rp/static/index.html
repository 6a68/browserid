<html>

<head>
  <title>All My Words</title>
  <style>
body {
  background-color: #000055;
  color: #ccc;
}

#appcontainer {
  width: 600px;
  margin: auto;
  font: 200 14px/1.2 "League Gothic", Haettenschweiler, sans-serif;
}

#sitetitle {
  font-size: 2em;
  color: #fff;
  font-weight: bold;
  margin-left: -2em;
  margin-top: -200px;
  padding-bottom: 200px;
}

a {
  color: #fff;
}

#logininstructions {
  width: 300px;
  margin: auto;
}

.content {
  display: none;
}

  </style>
</head>

</style>
</head>
  
<body>
<div id="appcontainer">
<div id="sitetitle">All My Words</div>
<p class="content">
This is a simple tool that lets your 5 year old collect all of the
words they know on the computer.  Its an introduction to task driven
computer usage for little ones.  It's <i>also</i> (uh, and primarily)
an example app that uses Mozilla ID for an awesome login experience.
</p>

<p class="content" id="logininstructions">
  To get started, <a href="#" id="login">log in</a>.
</p>
</div>
</body>
<script src="jquery-min.js"></script>
<script src="http://authority.mozilla.org/include.js"></script>
<script>
  $(document).ready(function() {
    $(".content").fadeIn(700);

    $("#sitetitle").animate({ "marginTop": "0px", "paddingBottom": "0px" }, "fast");
    $("#sitetitle").animate({ "marginTop": "-10px", "paddingBottom": "10px" }, "medium");
    $("#sitetitle").animate({"marginTop": "0px", "paddingBottom": "0px" }, "medium");
    $("#sitetitle").animate({ "marginTop": "-6px", "paddingBottom": "6px" }, "slow");
    $("#sitetitle").animate({"marginTop": "0px", "paddingBottom": "0px" }, "slow");

    $("#login").click(function() {
      $("#logininstructions").empty().text("logging you in using mozilla ID...");
      navigator.id.getVerifiedEmail(function(assertion) {
        // assertion at this point is a blob that looks like this:
        //
        // {
        //   audience: "mywords.com",
        //   valid-until: <format TBD>,
        //   email: "sophia@hilaiel.coom"
        // }
        //
        // Now we'll send this assertion up to the mywords server for
        // validation
        $("#logininstructions").empty().html($("<p>verifying your identity of <i>" + assertion + "</i></p>"));

        $.ajax({
          url: '/login',
          data: JSON.stringify(assertion),
          success: function(data, textStatus, jqXHR) {
            // we've got a response from the server half of the mywords
            // application which has validated the assertion
            $("#logininstructions").empty().text("verification complete: " + data);
          },
          error: function(jqXHR, textStatus, errorThrown) {
            $("#logininstructions").empty().text("verification failed: " + jqXHR.responseText);
          }
        })
      }, function(code, msg) {
        alert("something very bad happened! ("+code+"): " + msg); 
      });
    });
  });
</script>

</html>
